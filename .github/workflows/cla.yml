name: CLA Assistant

on:
  issue_comment:
    types: [created]
  pull_request_target:
    types: [opened, synchronize, reopened]

# SECURITY: This workflow uses pull_request_target which runs with write access
# to the base branch. Do NOT add steps that checkout or build PR code.

permissions:
  contents: write
  pull-requests: write
  statuses: write

jobs:
  cla-check:
    if: |
      (github.event_name == 'pull_request_target') ||
      (github.event_name == 'issue_comment' &&
       github.event.issue.pull_request)
    runs-on: ubuntu-latest
    steps:
      - name: CLA Assistant
        uses: contributor-assistant/github-action@ca4a40a7d1004f18d9960b404b97e5f30a505a08 # v2.6.1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          PERSONAL_ACCESS_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          path-to-signatures: "signatures/cla.json"
          path-to-document: "https://soleur.ai/pages/legal/individual-cla.html"
          branch: "cla-signatures"
          allowlist: "dependabot[bot],github-actions[bot],renovate[bot]"
          custom-notsigned-prcomment: |
            Thank you for your contribution! Before we can accept it, you need to sign our [Contributor License Agreement](https://soleur.ai/pages/legal/individual-cla.html).

            **Why?** Soleur uses a Business Source License (BSL 1.1) and supports dual licensing. The CLA ensures Jikigai has the rights needed to maintain and distribute your contribution under all applicable licenses, while you retain your copyright.

            **How to sign:** Comment on this PR with the following text:

            > I have read the CLA Document and I hereby sign the CLA

            If your employer owns your work, please ask them to sign the [Corporate CLA](https://soleur.ai/pages/legal/corporate-cla.html) by contacting legal@jikigai.com.
          custom-pr-sign-comment: "I have read the CLA Document and I hereby sign the CLA"
          custom-allsigned-prcomment: "All contributors have signed the CLA. Thank you!"
          lock-pullrequest-aftermerge: false
          use-dco-flag: false
