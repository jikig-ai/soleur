---
title: "feat: Migrate docs to Markdown + Eleventy with reusable docs-site skill"
type: feat
date: 2026-02-18
---

# feat: Migrate docs to Markdown + Eleventy with reusable docs-site skill

## Overview

Migrate Soleur's documentation site from 5 hand-maintained HTML files to Markdown + Eleventy (11ty) and package the setup as a reusable `docs-site` skill. Build-time data injection replaces hardcoded version strings and component counts. Catalog pages (agents, skills) auto-generate from source file frontmatter.

## Problem Statement / Motivation

Adding a new agent/skill requires manually editing HTML cards and syncing counts across 5+ files. Raw HTML is token-heavy for LLM operations (~1,247 lines across 5 pages). The docs infrastructure is not reusable by other projects. Build-time data injection eliminates version badge cascading and count staleness.

## Non-Goals

- Full visual redesign of the documentation site
- Adding new documentation pages beyond the existing 5
- Migrating away from GitHub Pages hosting
- Building a general-purpose SSG framework (opinionated skill, not a library)
- Changing the changelog rendering approach (stays client-side)

## Proposed Solution

Use Eleventy v3 (ESM) as a static site generator. Keep the existing CSS design system. Author editorial content in Markdown, catalog pages in Nunjucks templates consuming data files. Changelog stays client-side (current JS fetching from GitHub). Package the pattern as a `docs-site` skill with neutral starter templates.

## Critical Design Decisions

| # | Question | Decision | Rationale |
|---|----------|----------|-----------|
| 1 | Source/output directories | Source: `plugins/soleur/docs/` (restructured). Output: `_site/` at repo root. Config: `eleventy.config.js` at repo root. | Data files need easy access to `plugins/soleur/agents/`, `plugins/soleur/skills/`, `plugin.json`. Repo root config is cleanest. |
| 2 | URL stability | Exact match via `permalink` frontmatter. `/pages/agents.html` stays `/pages/agents.html`. | Existing links (README, Discord, search engines) must not break. |
| 3 | Skill categorization | Mapping object in `_data/skills.js`. No SKILL.md frontmatter changes. | Pragmatic -- skill categories change rarely (last consolidation: 2026-02-17). Avoids touching 37 files. Migrate to frontmatter later if needed. |
| 4 | Eleventy version | v3.x (ESM, `eleventy.config.js`). | Current stable. No CJS constraints. ESM is LLM-friendly. |
| 5 | Changelog rendering | Client-side (keep current JS). Changelog page wraps existing `<script>` in the base layout. | Works, always up-to-date, avoids building a custom Markdown parser. Eliminates `_data/changelog.js` from scope. |
| 6 | Deploy trigger scope | Expand to include `plugins/soleur/agents/**`, `plugins/soleur/skills/**`, `plugins/soleur/CHANGELOG.md`, `plugins/soleur/.claude-plugin/plugin.json`. | Adding a new agent must trigger docs rebuild. |
| 7 | Skill abstraction | Neutral starter templates. Soleur uses custom branded templates alongside. | Too Soleur-specific = no one else can use it. |
| 8 | release-docs fate | Refactor: remove HTML editing instructions, keep plugin.json/README.md count updates only. | Catalog pages auto-generate; HTML editing is obsolete. |
| 9 | sitemap.xml | Auto-generate from page collection via Nunjucks template. | Eliminates another sync maintenance point. Trivial in Eleventy (~10 lines). |
| 10 | Required frontmatter | `title`, `description`, `layout`, `permalink`. Optional: `ogImage`, `order`. | Minimum for SEO and routing. |

## Technical Approach

### Directory Structure (After Migration)

```
/ (repo root)
  eleventy.config.js              # Eleventy v3 config (ESM)
  package.json                    # Add @11ty/eleventy devDependency
  .gitignore                      # Add _site/
  plugins/soleur/
    docs/                         # Eleventy input directory
      _data/
        site.json                 # Site name, URL, nav items
        plugin.js                 # Reads ../.claude-plugin/plugin.json
        stats.js                  # Counts agents/skills/commands at build time
        agents.js                 # Reads agent frontmatter, groups by domain
        skills.js                 # Reads skill frontmatter + category mapping, groups by category
      _includes/
        base.njk                  # Base HTML layout (head, header, nav, footer)
      css/
        style.css                 # Existing CSS (passthrough, unchanged)
      fonts/                      # Existing fonts (passthrough)
      images/                     # Existing images (passthrough)
      screenshots/                # Existing screenshots (passthrough)
      index.njk                   # Landing page (complex layout, Nunjucks)
      404.njk                     # Error page (Nunjucks, preserves current design)
      pages/
        agents.njk                # Agent catalog (data-driven template)
        skills.njk                # Skill catalog (data-driven template)
        getting-started.md        # Prose content (Markdown)
        changelog.njk             # Wraps existing client-side JS in base layout
      CNAME                       # Passthrough
      robots.txt                  # Passthrough
      .nojekyll                   # Passthrough
  _site/                          # Eleventy output (gitignored)
```

### Implementation Phases

#### Phase 1: Foundation + Data Pipeline

- [x] Install `@11ty/eleventy@^3.0.0` as devDependency, add `"type": "module"` to package.json
- [x] Add npm scripts: `"docs:dev": "npx @11ty/eleventy --serve"`, `"docs:build": "npx @11ty/eleventy"`
- [x] Create `eleventy.config.js` at repo root (see config below)
- [x] Add `_site/` to `.gitignore`
- [x] Create `_data/site.json` with site name, URL, nav items
- [x] Create `_data/plugin.js` -- reads `plugins/soleur/.claude-plugin/plugin.json`
- [x] Create `_data/stats.js` -- counts agents, skills, commands from file system
- [x] Create `_data/agents.js` -- reads agent `.md` frontmatter, derives domain/sub from directory path, groups into structured data
- [x] Create `_data/skills.js` -- reads SKILL.md frontmatter, uses inline category mapping object to group by category
- [x] Create `_includes/base.njk` extracting common HTML shell from current pages:
  - Head with meta tags from frontmatter (`title`, `description`)
  - Note: SEO description must be set in template body or computed data, NOT in YAML frontmatter (Nunjucks variables are not resolved in frontmatter)
  - Header with nav links, `aria-current="page"` based on `page.url`
  - Main content slot (`{{ content | safe }}`)
  - Footer
- [x] Convert `getting-started.html` to `getting-started.md` as proof of concept
- [ ] Write unit tests for data files (`_data/agents.js`, `_data/skills.js`, `_data/stats.js`)
- [x] Run build, verify getting-started page renders correctly

**Success gate:** `getting-started.html` renders identically (same CSS, fonts, nav, footer). Data files return correct counts and groupings.

`eleventy.config.js`:

```javascript
// eleventy.config.js (ESM)
export default function (eleventyConfig) {
  // Passthrough static assets (paths relative to input directory)
  eleventyConfig.addPassthroughCopy("css");
  eleventyConfig.addPassthroughCopy("fonts");
  eleventyConfig.addPassthroughCopy("images");
  eleventyConfig.addPassthroughCopy("screenshots");
  eleventyConfig.addPassthroughCopy("CNAME");
  eleventyConfig.addPassthroughCopy("robots.txt");
  eleventyConfig.addPassthroughCopy(".nojekyll");
}

export const config = {
  dir: {
    input: "plugins/soleur/docs",
    output: "_site",
    includes: "_includes",
    data: "_data",
  },
  markdownTemplateEngine: "njk",
  htmlTemplateEngine: "njk",
  templateFormats: ["md", "njk", "html"],
};
```

Note: Passthrough paths are relative to the input directory (`plugins/soleur/docs/`), not the repo root. Eleventy resolves them within the input dir.

`_data/skills.js` (with inline category mapping):

```javascript
import { readdirSync, readFileSync } from "node:fs";
import { join, resolve } from "node:path";

// Category mapping -- update here when skills are added/reorganized
const SKILL_CATEGORIES = {
  "changelog": "Content & Release",
  "compound-docs": "Content & Release",
  "deploy": "Content & Release",
  // ... all 37 mappings
  "ship": "Workflow",
  "triage": "Workflow",
};

export default function () {
  const skillsDir = resolve("plugins/soleur/skills");
  // Read SKILL.md files, extract name + description
  // Apply category from SKILL_CATEGORIES mapping
  // Group by category, sort within groups
  // Return { categories: [{ name, count, skills: [...] }] }
}
```

#### Phase 2: Page Migration

- [x] **`pages/agents.njk`** -- Nunjucks template iterating over `agents` data, grouped by domain with sub-category sections. Each agent renders as a `.component-card` with colored dot. Uses `permalink: pages/agents.html`.
- [x] **`pages/skills.njk`** -- Same pattern, iterating over `skills` data grouped by category. Uses `permalink: pages/skills.html`.
- [x] **`pages/changelog.njk`** -- Minimal template using base layout, embeds the existing `<script>` block for client-side CHANGELOG.md rendering. Uses `permalink: pages/changelog.html`.
- [x] **`index.njk`** -- Landing page (hero, stats strip using `{{ stats.agents }}`, problem cards, feature grid, CTA). Uses `permalink: index.html`.
- [x] **`404.njk`** -- Error page preserving current design. Uses `permalink: 404.html`.
- [x] **`sitemap.njk`** -- Auto-generates sitemap.xml from page collection. Uses `permalink: sitemap.xml`.
- [x] Delete old HTML source files (replaced by templates + build output)
- [ ] Visual comparison of all pages against current live site
- [ ] Verify URL stability: compare output file paths against current sitemap.xml

**Important: Template variable limitation.** Nunjucks variables (`{{ stats.agents }}`) are NOT resolved inside YAML frontmatter. Dynamic meta descriptions must be constructed in the base layout template using conditionals or Eleventy computed data, not in page frontmatter.

**Success gate:** All pages visually match current live site. All URLs identical. Fonts, images, category colors render correctly. Mobile nav toggle works.

#### Phase 3: Build, Deploy & Skill Updates

- [x] Update `.github/workflows/deploy-docs.yml`:
  - Add Node.js 20 setup + `npm ci` + `npx @11ty/eleventy` build steps
  - Change upload artifact path from `plugins/soleur/docs` to `_site`
  - Expand path trigger to: `plugins/soleur/docs/**`, `plugins/soleur/agents/**`, `plugins/soleur/skills/**`, `plugins/soleur/commands/**`, `plugins/soleur/CHANGELOG.md`, `plugins/soleur/.claude-plugin/plugin.json`, `eleventy.config.js`
  - Remove old validation step (build success replaces it)
- [x] Verify build output: all files present, CNAME correct, fonts load, 404.html present
- [ ] Run Lighthouse comparison against current site (must be within 5 points)
- [x] **Create `docs-site` skill** at `plugins/soleur/skills/docs-site/SKILL.md`:
  - Scaffolding instructions for a new Eleventy docs site
  - Neutral starter templates (basic layout, minimal CSS)
  - Data file patterns for version injection
  - GitHub Actions workflow template
  - NOT Soleur-branded
- [x] **Refactor `release-docs` skill**:
  - Remove HTML file editing instructions
  - Keep plugin.json/README.md/marketplace.json count updates
  - Add: "Run `npm run docs:build` to verify catalog pages"
- [x] **Refactor `deploy-docs` skill**:
  - Remove checks for deleted pages (commands.html, mcp-servers.html)
  - Update validation for `_site/` output
  - Update embedded workflow YAML

**Success gate:** Build produces correct output. Skills reference new workflow. No old HTML file references remain.

## Acceptance Criteria

- [ ] All 5 pages + 404 render with equivalent content and visual design
- [ ] Version sourced from plugin.json at build time (not hardcoded)
- [ ] Component counts on index, agents, and skills pages match actual inventory
- [ ] URLs identical to current site (no broken links)
- [ ] GitHub Pages deployment works via updated Actions workflow
- [ ] Adding a new agent/skill requires only adding the source file + updating skills.js mapping (no HTML edits)
- [ ] `docs-site` skill exists with scaffolding instructions
- [ ] `release-docs` and `deploy-docs` skills updated for new workflow
- [ ] Fonts, images, and CSS load correctly in output
- [ ] Lighthouse score within 5 points of current site
- [ ] Unit tests pass for data files

## Test Scenarios

- Given a new agent file is added to `plugins/soleur/agents/engineering/review/new-agent.md` with valid frontmatter, when `npm run docs:build` is run, then the agent appears on the agents catalog page under Engineering/Review
- Given a skill name is mapped to "Development" in `_data/skills.js`, when the site builds, then the skill appears in the Development section of the skills page
- Given plugin.json version is "2.14.0", when the site builds, then the landing page footer/stats display "2.14.0"
- Given the site is built with `npx @11ty/eleventy`, when output URLs are compared to current sitemap.xml, then all URLs match exactly
- Given a SKILL.md file has missing `name` field in frontmatter, when the site builds, then the build skips the file with a warning (does not render an empty card)
- Given the deploy workflow runs on a push to main that modifies `plugins/soleur/agents/`, when the workflow completes, then the docs site reflects the change
- Given the changelog page loads in a browser, when the page renders, then CHANGELOG.md content appears (fetched client-side from GitHub)

## Dependencies & Risks

**Dependencies:**
- Eleventy v3.x stable (currently 3.1.2)
- Node.js 20+ in GitHub Actions

**Risks:**
- **Font path breakage:** CSS references fonts with relative URLs (`../fonts/inter.woff2`). If passthrough copy changes relative position of CSS to fonts, fonts load with fallback system fonts (silent failure). Mitigation: verify font loading in build output before merging.
- **URL mismatch:** Eleventy default "pretty URLs" would change `/pages/agents.html` to `/pages/agents/`. Mitigation: explicit `permalink` on every page.
- **Skill category mapping drift:** The inline mapping in `_data/skills.js` can drift from actual skill inventory. Mitigation: `_data/stats.js` validates that all skills have a category mapping and warns on build if any are unmapped.

## Rollback Plan

Revert the merge commit. The old HTML files are restored from git history. GitHub Pages redeploys the static HTML. No data is lost. The `_site/` output directory is gitignored, so reverting removes only source files.

## Version Bump

**Intent:** MINOR bump (new `docs-site` skill added).

## References

- Brainstorm: `knowledge-base/brainstorms/2026-02-18-md-to-html-docs-brainstorm.md`
- Spec: `knowledge-base/specs/feat-md-to-html-docs/spec.md`
- Issue: #120
- Eleventy v3 docs: https://www.11ty.dev/docs/
- Current site: https://soleur.ai
